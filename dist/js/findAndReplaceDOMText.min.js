/**
 * findAndReplaceDOMText v0.3.0
 * @author James Padolsey http://james.padolsey.com
 * @license http://unlicense.org/UNLICENSE
 *
 * Matches the text of a DOM node against a regular expression
 * and replaces each match (or node-separated portions of the match)
 * in the specified element.
 *
 * Example: Wrap 'test' in <em>:
 *   <p id="target">This is a test</p>
 *   <script>
 *     findAndReplaceDOMText(
 *       /test/,
 *       document.getElementById('target'),
 *       'em'
 *     );
 *   </script>
 */(function(e,t){typeof module=="object"&&module.exports?module.exports=t(e):typeof define=="function"&&define.amd?define([e],t):e.findAndReplaceDOMText=t(e)})(this,function(e){function t(e,t,s,u,a){var f,l=[],c=r(t,a),h=o(s);if(!c)return;if(e.global)while(f=e.exec(c))l.push(n(f,u));else f=c.match(e),l.push(n(f,u));l.length&&i(t,l,h,a)}function n(e,t){t=t||0;if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var n=e.index;if(t>0){var r=e[t];if(!r)throw"Invalid capture group";n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}function r(e,t){if(e.nodeType===3)return e.data;if(t&&!t(e))return"";var n="";if(e=e.firstChild)do n+=r(e,t);while(e=e.nextSibling);return n}function i(e,t,n,r){var i,s,o,u,a=[],f=0,l=e,c=t.shift(),h=0,p;e:for(;;){l.nodeType===3&&(!s&&l.length+f>=c[1]?(s=l,u=c[1]-f):i&&a.push(l),!i&&l.length+f>c[0]&&(i=l,o=c[0]-f),f+=l.length),p=l.nodeType===1&&r&&!r(l);if(i&&s){l=n({startNode:i,startNodeIndex:o,endNode:s,endNodeIndex:u,innerNodes:a,match:c[2],matchIndex:h}),f-=s.length-u,i=null,s=null,a=[],c=t.shift(),h++;if(!c)break}else if(!p&&(l.firstChild||l.nextSibling)){l=l.firstChild||l.nextSibling;continue}for(;;){if(l.nextSibling){l=l.nextSibling;break}if(l.parentNode===e)break e;l=l.parentNode}}}function o(t){s=[];var n;if(typeof t!="function"){var r=t.nodeType?t:e.document.createElement(t);n=function(t){var n=e.document.createElement("div"),i;return n.innerHTML=r.outerHTML||(new e.XMLSerializer).serializeToString(r),i=n.firstChild,t&&i.appendChild(e.document.createTextNode(t)),i}}else n=t;return function(r){var i=r.startNode,o=r.endNode,u=r.matchIndex,a,f;if(i===o){var l=i;r.startNodeIndex>0&&(a=e.document.createTextNode(l.data.substring(0,r.startNodeIndex)),l.parentNode.insertBefore(a,l));var c=n(r.match[0],u,r.match[0]);return l.parentNode.insertBefore(c,l),r.endNodeIndex<l.length&&(f=e.document.createTextNode(l.data.substring(r.endNodeIndex)),l.parentNode.insertBefore(f,l)),l.parentNode.removeChild(l),s.push(function(){var e=c.parentNode;e.insertBefore(c.firstChild,c),e.removeChild(c),e.normalize()}),c}a=e.document.createTextNode(i.data.substring(0,r.startNodeIndex)),f=e.document.createTextNode(o.data.substring(r.endNodeIndex));var h=n(i.data.substring(r.startNodeIndex),u,r.match[0]),p=[];for(var d=0,v=r.innerNodes.length;d<v;++d){var m=r.innerNodes[d],g=n(m.data,u,r.match[0]);m.parentNode.replaceChild(g,m),p.push(g)}var y=n(o.data.substring(0,r.endNodeIndex),u,r.match[0]);return i.parentNode.insertBefore(a,i),i.parentNode.insertBefore(h,i),i.parentNode.removeChild(i),o.parentNode.insertBefore(y,o),o.parentNode.insertBefore(f,o),o.parentNode.removeChild(o),s.push(function(){p.unshift(h),p.push(y);for(var e=0,t=p.length;e<t;++e){var n=p[e],r=n.parentNode;r.insertBefore(n.firstChild,n),r.removeChild(n),r.normalize()}}),y}}var s;return t.revert=function(){for(var t=0,n=s.length;t<n;++t)s[t]();s=[]},t});